generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"

}

enum Role {
  ADMIN
  STUDENT
}

model User {
  id                String   @id @default(uuid())

  // ✅ Login uchun email majburiy
  email             String   @unique
  passwordHash      String

  // ✅ Model talablaringizdagi ism/familya
  firstName         String
  lastName          String

  // ✅ Studentda age bo‘ladi, adminda null bo‘lishi mumkin
  age               Int?


  imagePath         String?

  role              Role     @default(STUDENT)

   // ✅ Google login uchun
  googleSub        String?  @unique  // Google user unique id (sub)

  // ✅ Refresh token’ni DB’da hash ko‘rinishida saqlaymiz (xavfsizroq)
  refreshTokenHash  String?

  // ✅ Forgot/Reset password uchun kod va vaqt
  resetCodeHash     String?
  resetCodeExp      DateTime?

  // ✅ Delete account uchun 5 xonali kod
  deleteCodeHash    String?
  deleteCodeExp     DateTime?

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt


  // signin da Login Attempt Lock (5x xato → 15 min) 5 marta xato loginparol tersa 15 minutga bloklanadi
  failedLoginCount Int      @default(0)
  lockUntil        DateTime?


}
